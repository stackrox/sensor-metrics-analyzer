rule_type = "histogram"
metric_name = "rox_sensor_k8s_event_processing_duration"
display_name = "rox_sensor_k8s_event_processing_duration"
description = """
K8s event processing duration in milliseconds.
It measures how long the listenerâ€™s dispatcher takes to process a single Kubernetes event, 
from right before ProcessEvent starts until right after it finishes and the metric is recorded. 
It does not include resolver, detector, or sending to Central.
"""

reviewed = "Partially, by a human"
last_review_by = "Piotr"
last_review_on = "30-01-2026"

[histogram_config]
unit = "ms"

[thresholds]
p95_good = 256
p95_warn = 512

[messages]
green = "p95={p95:.3f}s, p99={p99:.3f}s (good)"
yellow = "p95={p95:.3f}s, p99={p99:.3f}s (elevated)"
red = "p95={p95:.3f}s, p99={p99:.3f}s (high latency)"

[remediation]
red = "High K8s event processing latency. Check event handler performance."
yellow = "Monitor event processing latency."

acs_versions = ["4.7+", "4.8+", "4.9+"]

